+ export CUDA_LAUNCH_BLOCKING=0
+ CUDA_LAUNCH_BLOCKING=0
+ export VLLM_USE_MODELSCOPE=0
+ VLLM_USE_MODELSCOPE=0
+ export VLLM_WORKER_MULTIPROC_METHOD=spawn
+ VLLM_WORKER_MULTIPROC_METHOD=spawn
+ export VLLM_ATTENTION_BACKEND=XFORMERS
+ VLLM_ATTENTION_BACKEND=XFORMERS
+ export VLLM_HOST_IP=localhost
+ VLLM_HOST_IP=localhost
+ export RAY_DEDUP_LOGS=0
+ RAY_DEDUP_LOGS=0
+ export VLLM_LOGGING_LEVEL=INFO
+ VLLM_LOGGING_LEVEL=INFO
+ export RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
+ RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
+ export CUDA_VISIBLE_DEVICES=0,1,2,3
+ CUDA_VISIBLE_DEVICES=0,1,2,3
+ gpu_memory_utilization=0.40
++ echo 0,1,2,3
++ tr -cd ,
++ wc -c
+ export NUM_GPUS=3
+ NUM_GPUS=3
+ (( NUM_GPUS++ ))
+ export train_batch_size=4
+ train_batch_size=4
+ export tensor_model_parallel_size=1
+ tensor_model_parallel_size=1
+ export n_gpus_per_node=4
+ n_gpus_per_node=4
+ pure_agent_model_name=Qwen2.5-3B-Instruct
+ export TMPDIR=/home/pct4et/tmp
+ TMPDIR=/home/pct4et/tmp
+ export RAY_TMPDIR=/home/pct4et/tmp
+ RAY_TMPDIR=/home/pct4et/tmp
+ task_name=sciworld
+ cd AgentGym-RL
+ export VLLM_ATTENTION_BACKEND=XFORMERS
+ VLLM_ATTENTION_BACKEND=XFORMERS
+ export WANDB_BASE_URL=https://api.wandb.ai
+ WANDB_BASE_URL=https://api.wandb.ai
+ export env_server_url=http://localhost:36001
+ env_server_url=http://localhost:36001
+ agent_model_path=/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct
+ kl_coef=0.001
+ policy_learning_rate=1e-6
+ rollout_sample_num=1
+ ppo_mini_batch_size=1
+ ppo_micro_batch_size_per_gpu=1
+ ppo_inner_epochs=1
+ total_epoches=10
+ model_save_dir=saves
+ mkdir -p saves
+ exp_name=test
+ model_save_path=saves/test
+ mkdir -p saves/test
+ rm -rf /home/pct4et/tmp/ray
+ HYDRA_FULL_ERROR=1
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ WANDB_MODE=online
+ python -m verl.agent_trainer.main_ppo algorithm.adv_estimator=grpo algorithm.rounds_ctrl.type=fixed algorithm.rounds_ctrl.rounds=20 data.train_file=AgentItemId/sciworld_train.json data.train_batch_size=4 data.max_prompt_length=1024 data.max_response_length=4096 actor_rollout_ref.agentgym.task_name=sciworld actor_rollout_ref.agentgym.env_addr=http://localhost:36001 actor_rollout_ref.agentgym.timeout=600 actor_rollout_ref.model.path=/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.001 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.rollout.gpu_memory_utilization=0.40 actor_rollout_ref.rollout.n=1 actor_rollout_ref.rollout.max_model_len=32768 actor_rollout_ref.rollout.max_tokens=200 actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.actor.ppo_epochs=1 actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.actor.ppo_mini_batch_size=1 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1 actor_rollout_ref.rollout.rollout_log_dir=saves/test/executer_logs algorithm.kl_ctrl.kl_coef=0.001 trainer.default_local_dir=saves/test trainer.n_gpus_per_node=4 trainer.nnodes=1 trainer.project_name=ag trainer.experiment_name=test trainer.save_freq=25 trainer.total_epochs=10
2025-11-21 11:39:24.964606: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1763743165.354396  493380 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1763743165.507131  493380 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-21 11:39:26.422628: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
2025-11-21 11:39:45,966	INFO worker.py:2012 -- Started a local Ray instance.
[36m(pid=502201)[0m 2025-11-21 11:40:02.121410: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=502201)[0m WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
[36m(pid=502201)[0m E0000 00:00:1763743202.139898  502201 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=502201)[0m E0000 00:00:1763743202.145668  502201 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=502201)[0m 2025-11-21 11:40:02.164414: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=502201)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=502201)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=502201)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=502201)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=502201)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=502201)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(main_task pid=502201)[0m {'actor_rollout_ref': {'actor': {'clip_ratio': 0.2,
[36m(main_task pid=502201)[0m                                  'entropy_coeff': 0.001,
[36m(main_task pid=502201)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=502201)[0m                                                  'grad_offload': False,
[36m(main_task pid=502201)[0m                                                  'optimizer_offload': False,
[36m(main_task pid=502201)[0m                                                  'param_offload': False,
[36m(main_task pid=502201)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=502201)[0m                                  'grad_clip': 1.0,
[36m(main_task pid=502201)[0m                                  'kl_loss_coef': 0.001,
[36m(main_task pid=502201)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(main_task pid=502201)[0m                                  'optim': {'lr': 1e-06,
[36m(main_task pid=502201)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=502201)[0m                                            'min_lr_ratio': None,
[36m(main_task pid=502201)[0m                                            'total_training_steps': -1,
[36m(main_task pid=502201)[0m                                            'warmup_style': 'constant'},
[36m(main_task pid=502201)[0m                                  'ppo_epochs': 1,
[36m(main_task pid=502201)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(main_task pid=502201)[0m                                  'ppo_micro_batch_size': None,
[36m(main_task pid=502201)[0m                                  'ppo_micro_batch_size_per_gpu': 1,
[36m(main_task pid=502201)[0m                                  'ppo_mini_batch_size': 1,
[36m(main_task pid=502201)[0m                                  'shuffle': False,
[36m(main_task pid=502201)[0m                                  'strategy': 'fsdp',
[36m(main_task pid=502201)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=502201)[0m                                  'use_dynamic_bsz': False,
[36m(main_task pid=502201)[0m                                  'use_kl_loss': True},
[36m(main_task pid=502201)[0m                        'agentgym': {'env_addr': 'http://localhost:36001',
[36m(main_task pid=502201)[0m                                     'max_retries': 10,
[36m(main_task pid=502201)[0m                                     'max_rounds': 10,
[36m(main_task pid=502201)[0m                                     'task_name': 'sciworld',
[36m(main_task pid=502201)[0m                                     'timeout': 600},
[36m(main_task pid=502201)[0m                        'hybrid_engine': True,
[36m(main_task pid=502201)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=502201)[0m                                  'external_lib': None,
[36m(main_task pid=502201)[0m                                  'override_config': {},
[36m(main_task pid=502201)[0m                                  'path': '/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct',
[36m(main_task pid=502201)[0m                                  'use_remove_padding': False},
[36m(main_task pid=502201)[0m                        'ref': {'fsdp_config': {'param_offload': False,
[36m(main_task pid=502201)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=502201)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(main_task pid=502201)[0m                                'log_prob_micro_batch_size': None,
[36m(main_task pid=502201)[0m                                'log_prob_micro_batch_size_per_gpu': 1,
[36m(main_task pid=502201)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(main_task pid=502201)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(main_task pid=502201)[0m                        'rollout': {'disable_log_stats': True,
[36m(main_task pid=502201)[0m                                    'do_sample': True,
[36m(main_task pid=502201)[0m                                    'dtype': 'bfloat16',
[36m(main_task pid=502201)[0m                                    'enable_chunked_prefill': True,
[36m(main_task pid=502201)[0m                                    'enforce_eager': True,
[36m(main_task pid=502201)[0m                                    'free_cache_engine': True,
[36m(main_task pid=502201)[0m                                    'gpu_memory_utilization': 0.4,
[36m(main_task pid=502201)[0m                                    'ignore_eos': False,
[36m(main_task pid=502201)[0m                                    'load_format': 'dummy_dtensor',
[36m(main_task pid=502201)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(main_task pid=502201)[0m                                    'log_prob_micro_batch_size': None,
[36m(main_task pid=502201)[0m                                    'log_prob_micro_batch_size_per_gpu': 1,
[36m(main_task pid=502201)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(main_task pid=502201)[0m                                    'max_model_len': 32768,
[36m(main_task pid=502201)[0m                                    'max_num_batched_tokens': 8192,
[36m(main_task pid=502201)[0m                                    'max_num_seqs': 1024,
[36m(main_task pid=502201)[0m                                    'max_tokens': 200,
[36m(main_task pid=502201)[0m                                    'n': 1,
[36m(main_task pid=502201)[0m                                    'name': 'vllm',
[36m(main_task pid=502201)[0m                                    'prompt_length': 1024,
[36m(main_task pid=502201)[0m                                    'response_length': 4096,
[36m(main_task pid=502201)[0m                                    'rollout_log_dir': 'saves/test/executer_logs',
[36m(main_task pid=502201)[0m                                    'send_interval': 1,
[36m(main_task pid=502201)[0m                                    'temperature': 1.0,
[36m(main_task pid=502201)[0m                                    'tensor_model_parallel_size': 1,
[36m(main_task pid=502201)[0m                                    'top_k': -1,
[36m(main_task pid=502201)[0m                                    'top_p': 1}},
[36m(main_task pid=502201)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(main_task pid=502201)[0m                'gamma': 1.0,
[36m(main_task pid=502201)[0m                'kl_ctrl': {'kl_coef': 0.001, 'type': 'fixed'},
[36m(main_task pid=502201)[0m                'kl_penalty': 'kl',
[36m(main_task pid=502201)[0m                'lam': 1.0,
[36m(main_task pid=502201)[0m                'rounds_ctrl': {'rounds': 20,
[36m(main_task pid=502201)[0m                                'steps_scaling_inter': 100,
[36m(main_task pid=502201)[0m                                'type': 'fixed'}},
[36m(main_task pid=502201)[0m  'critic': {'cliprange_value': 0.5,
[36m(main_task pid=502201)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=502201)[0m             'forward_micro_batch_size': None,
[36m(main_task pid=502201)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(main_task pid=502201)[0m             'grad_clip': 1.0,
[36m(main_task pid=502201)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=502201)[0m                       'external_lib': None,
[36m(main_task pid=502201)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=502201)[0m                                       'grad_offload': False,
[36m(main_task pid=502201)[0m                                       'optimizer_offload': False,
[36m(main_task pid=502201)[0m                                       'param_offload': False,
[36m(pid=gcs_server)[0m [2025-11-21 11:40:14,248 E 493949 493949] (gcs_server) gcs_server.cc:302: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[33m(raylet)[0m [2025-11-21 11:40:15,931 E 494285 494285] (raylet) main.cc:975: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=504517)[0m 2025-11-21 11:40:21.115303: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=504517)[0m WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
[36m(pid=504517)[0m E0000 00:00:1763743221.133775  504517 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=504517)[0m E0000 00:00:1763743221.139612  504517 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=504517)[0m 2025-11-21 11:40:21.158083: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=504517)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=504517)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=504517)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=494415)[0m [2025-11-21 11:40:21,599 E 494415 494849] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494443)[0m [2025-11-21 11:40:21,615 E 494443 494934] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494407)[0m [2025-11-21 11:40:21,741 E 494407 495003] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494409)[0m [2025-11-21 11:40:21,724 E 494409 494975] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494432)[0m [2025-11-21 11:40:21,803 E 494432 495058] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=504517)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=494456)[0m [2025-11-21 11:40:22,152 E 494456 495415] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494428)[0m [2025-11-21 11:40:22,100 E 494428 495279] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494411)[0m [2025-11-21 11:40:22,139 E 494411 495341] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494468)[0m [2025-11-21 11:40:22,239 E 494468 495623] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494441)[0m [2025-11-21 11:40:22,393 E 494441 495926] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494461)[0m [2025-11-21 11:40:22,401 E 494461 495917] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494418)[0m [2025-11-21 11:40:22,481 E 494418 496117] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494454)[0m [2025-11-21 11:40:22,480 E 494454 496180] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494430)[0m [2025-11-21 11:40:22,480 E 494430 496201] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494527)[0m [2025-11-21 11:40:22,469 E 494527 496020] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494416)[0m [2025-11-21 11:40:22,482 E 494416 496204] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=504517)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=494442)[0m [2025-11-21 11:40:22,559 E 494442 496079] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494439)[0m [2025-11-21 11:40:22,545 E 494439 496335] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494433)[0m [2025-11-21 11:40:22,572 E 494433 496395] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494412)[0m [2025-11-21 11:40:22,565 E 494412 496310] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494450)[0m [2025-11-21 11:40:22,702 E 494450 496527] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494464)[0m [2025-11-21 11:40:22,734 E 494464 496656] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494410)[0m [2025-11-21 11:40:22,710 E 494410 496648] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494417)[0m [2025-11-21 11:40:22,724 E 494417 496653] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494420)[0m [2025-11-21 11:40:22,775 E 494420 496838] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494423)[0m [2025-11-21 11:40:22,831 E 494423 496977] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494422)[0m [2025-11-21 11:40:22,877 E 494422 497033] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494435)[0m [2025-11-21 11:40:22,796 E 494435 496736] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494488)[0m [2025-11-21 11:40:22,816 E 494488 496873] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494458)[0m [2025-11-21 11:40:22,820 E 494458 496911] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494497)[0m [2025-11-21 11:40:22,869 E 494497 496923] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494424)[0m [2025-11-21 11:40:22,883 E 494424 497233] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494421)[0m [2025-11-21 11:40:22,863 E 494421 497170] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494429)[0m [2025-11-21 11:40:22,866 E 494429 497192] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494425)[0m [2025-11-21 11:40:22,846 E 494425 497082] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494471)[0m [2025-11-21 11:40:22,989 E 494471 497499] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494507)[0m [2025-11-21 11:40:22,929 E 494507 497147] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494460)[0m [2025-11-21 11:40:22,932 E 494460 497306] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494414)[0m [2025-11-21 11:40:22,937 E 494414 497321] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494522)[0m [2025-11-21 11:40:22,989 E 494522 497562] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494431)[0m [2025-11-21 11:40:23,003 E 494431 497626] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494446)[0m [2025-11-21 11:40:23,048 E 494446 497357] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494436)[0m [2025-11-21 11:40:23,059 E 494436 497471] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494453)[0m [2025-11-21 11:40:23,099 E 494453 497968] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494491)[0m [2025-11-21 11:40:23,099 E 494491 497970] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494413)[0m [2025-11-21 11:40:23,061 E 494413 497721] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494510)[0m [2025-11-21 11:40:23,126 E 494510 498114] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494529)[0m [2025-11-21 11:40:23,041 E 494529 497723] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494449)[0m [2025-11-21 11:40:23,106 E 494449 497904] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494478)[0m [2025-11-21 11:40:23,062 E 494478 497860] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494479)[0m [2025-11-21 11:40:23,220 E 494479 498262] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494427)[0m [2025-11-21 11:40:23,251 E 494427 498352] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494457)[0m [2025-11-21 11:40:23,248 E 494457 498385] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494426)[0m [2025-11-21 11:40:23,277 E 494426 498626] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494505)[0m [2025-11-21 11:40:23,282 E 494505 498636] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494462)[0m [2025-11-21 11:40:23,294 E 494462 498593] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=504517)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=494487)[0m [2025-11-21 11:40:23,333 E 494487 498851] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494447)[0m [2025-11-21 11:40:23,345 E 494447 498894] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494490)[0m [2025-11-21 11:40:23,400 E 494490 499132] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494504)[0m [2025-11-21 11:40:23,398 E 494504 499016] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494489)[0m [2025-11-21 11:40:23,383 E 494489 499136] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494466)[0m [2025-11-21 11:40:23,383 E 494466 499134] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494469)[0m [2025-11-21 11:40:23,399 E 494469 499096] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494408)[0m [2025-11-21 11:40:23,346 E 494408 498871] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494486)[0m [2025-11-21 11:40:23,394 E 494486 499220] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494483)[0m [2025-11-21 11:40:23,419 E 494483 499365] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494519)[0m [2025-11-21 11:40:23,413 E 494519 499098] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494445)[0m [2025-11-21 11:40:23,416 E 494445 499363] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494459)[0m [2025-11-21 11:40:23,429 E 494459 499428] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494523)[0m [2025-11-21 11:40:23,497 E 494523 499767] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494531)[0m [2025-11-21 11:40:23,469 E 494531 499572] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494467)[0m [2025-11-21 11:40:23,451 E 494467 499507] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494492)[0m [2025-11-21 11:40:23,505 E 494492 499813] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494452)[0m [2025-11-21 11:40:23,465 E 494452 499685] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494438)[0m [2025-11-21 11:40:23,489 E 494438 499769] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494495)[0m [2025-11-21 11:40:23,462 E 494495 499512] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494485)[0m [2025-11-21 11:40:23,447 E 494485 499520] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494440)[0m [2025-11-21 11:40:23,503 E 494440 499835] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494493)[0m [2025-11-21 11:40:23,545 E 494493 499990] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494506)[0m [2025-11-21 11:40:23,507 E 494506 499910] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494534)[0m [2025-11-21 11:40:23,516 E 494534 499961] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494496)[0m [2025-11-21 11:40:23,461 E 494496 499513] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494444)[0m [2025-11-21 11:40:23,563 E 494444 500090] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494515)[0m [2025-11-21 11:40:23,595 E 494515 500178] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494448)[0m [2025-11-21 11:40:23,601 E 494448 500380] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494511)[0m [2025-11-21 11:40:23,620 E 494511 500354] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494535)[0m [2025-11-21 11:40:23,617 E 494535 500433] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494512)[0m [2025-11-21 11:40:23,649 E 494512 500608] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494501)[0m [2025-11-21 11:40:23,668 E 494501 500680] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494494)[0m [2025-11-21 11:40:23,583 E 494494 500230] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494520)[0m [2025-11-21 11:40:23,676 E 494520 500740] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494525)[0m [2025-11-21 11:40:23,620 E 494525 500434] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494434)[0m [2025-11-21 11:40:23,608 E 494434 500259] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494437)[0m [2025-11-21 11:40:23,654 E 494437 500610] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494480)[0m [2025-11-21 11:40:23,628 E 494480 500496] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494451)[0m [2025-11-21 11:40:23,636 E 494451 500530] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494419)[0m [2025-11-21 11:40:23,688 E 494419 500692] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494455)[0m [2025-11-21 11:40:23,690 E 494455 500950] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494499)[0m [2025-11-21 11:40:23,692 E 494499 500732] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494477)[0m [2025-11-21 11:40:23,722 E 494477 501105] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494537)[0m [2025-11-21 11:40:23,701 E 494537 500731] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494463)[0m [2025-11-21 11:40:23,716 E 494463 501107] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494475)[0m [2025-11-21 11:40:23,723 E 494475 501184] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494472)[0m [2025-11-21 11:40:23,727 E 494472 501246] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494502)[0m [2025-11-21 11:40:23,761 E 494502 501514] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494476)[0m [2025-11-21 11:40:23,748 E 494476 501430] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494517)[0m [2025-11-21 11:40:23,761 E 494517 501496] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494498)[0m [2025-11-21 11:40:23,761 E 494498 501491] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494465)[0m [2025-11-21 11:40:23,761 E 494465 501493] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494484)[0m [2025-11-21 11:40:23,768 E 494484 501498] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494516)[0m [2025-11-21 11:40:23,766 E 494516 501599] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494518)[0m [2025-11-21 11:40:23,783 E 494518 501660] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494503)[0m [2025-11-21 11:40:23,899 E 494503 501707] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494524)[0m [2025-11-21 11:40:23,901 E 494524 501709] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494513)[0m [2025-11-21 11:40:23,914 E 494513 501747] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494509)[0m [2025-11-21 11:40:23,918 E 494509 501863] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494514)[0m [2025-11-21 11:40:23,918 E 494514 501723] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494481)[0m [2025-11-21 11:40:23,918 E 494481 501857] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494500)[0m [2025-11-21 11:40:23,918 E 494500 501770] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494530)[0m [2025-11-21 11:40:23,918 E 494530 501844] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494536)[0m [2025-11-21 11:40:23,919 E 494536 501872] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=494533)[0m [2025-11-21 11:40:23,919 E 494533 501853] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2025-11-21 11:40:23,945 E 493380 494405] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(main_task pid=502201)[0m [2025-11-21 11:40:24,975 E 502201 502561] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=506459)[0m 2025-11-21 11:40:36.305644: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=506457)[0m 2025-11-21 11:40:36.303065: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=506457)[0m WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
[36m(pid=506457)[0m E0000 00:00:1763743236.321941  506457 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=506459)[0m WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
[36m(pid=506459)[0m E0000 00:00:1763743236.325866  506459 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=506459)[0m E0000 00:00:1763743236.331889  506459 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=506457)[0m E0000 00:00:1763743236.327814  506457 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=506459)[0m 2025-11-21 11:40:36.351477: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=506459)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=506459)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506457)[0m 2025-11-21 11:40:36.346777: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=506457)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=506457)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506458)[0m 2025-11-21 11:40:36.357681: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=506458)[0m WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
[36m(pid=506458)[0m E0000 00:00:1763743236.376429  506458 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=506458)[0m E0000 00:00:1763743236.382249  506458 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=506458)[0m 2025-11-21 11:40:36.400812: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=506458)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=506458)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506459)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506457)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506458)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506459)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506457)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506458)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506459)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506457)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506458)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506459)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506457)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(pid=506458)[0m AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
[36m(WorkerDict pid=504517)[0m [W1121 11:40:41.070610146 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
[36m(WorkerDict pid=506459)[0m [W1121 11:40:41.067316827 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
[36m(WorkerDict pid=506457)[0m [W1121 11:40:41.062540275 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
[36m(WorkerDict pid=506458)[0m [W1121 11:40:41.054039506 CUDAAllocatorConfig.h:28] Warning: expandable_segments not supported on this platform (function operator())
[36m(bundle_reservation_check_func pid=504308)[0m [2025-11-21 11:40:42,913 E 504308 504456] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=504517)[0m [2025-11-21 11:40:43,954 E 504517 504770] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=504517)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=506459)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=506457)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=506458)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.21it/s]
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.23it/s]
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s]
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.20it/s]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.46it/s]
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.53it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.48it/s]
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.53it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.47it/s]
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.46it/s]
[36m(main_task pid=502201)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=502201)[0m                       'override_config': {},
[36m(main_task pid=502201)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(main_task pid=502201)[0m                       'tokenizer_path': '/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct',
[36m(main_task pid=502201)[0m                       'use_remove_padding': False},
[36m(main_task pid=502201)[0m             'optim': {'lr': 1e-05,
[36m(main_task pid=502201)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=502201)[0m                       'min_lr_ratio': None,
[36m(main_task pid=502201)[0m                       'total_training_steps': -1,
[36m(main_task pid=502201)[0m                       'warmup_style': 'constant'},
[36m(main_task pid=502201)[0m             'ppo_epochs': 1,
[36m(main_task pid=502201)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=502201)[0m             'ppo_micro_batch_size': None,
[36m(main_task pid=502201)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(main_task pid=502201)[0m             'ppo_mini_batch_size': 1,
[36m(main_task pid=502201)[0m             'rollout_n': 1,
[36m(main_task pid=502201)[0m             'shuffle': False,
[36m(main_task pid=502201)[0m             'strategy': 'fsdp',
[36m(main_task pid=502201)[0m             'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=502201)[0m             'use_dynamic_bsz': False},
[36m(main_task pid=502201)[0m  'custom_reward_function': {'name': None, 'path': None},
[36m(main_task pid=502201)[0m  'data': {'max_prompt_length': 1024,
[36m(main_task pid=502201)[0m           'max_response_length': 4096,
[36m(main_task pid=502201)[0m           'prompt_key': 'item_id',
[36m(main_task pid=502201)[0m           'return_raw_chat': True,
[36m(main_task pid=502201)[0m           'return_raw_input_ids': False,
[36m(main_task pid=502201)[0m           'shuffle': True,
[36m(main_task pid=502201)[0m           'tokenizer': None,
[36m(main_task pid=502201)[0m           'train_batch_size': 4,
[36m(main_task pid=502201)[0m           'train_file': 'AgentItemId/sciworld_train.json',
[36m(main_task pid=502201)[0m           'val_batch_size': None,
[36m(main_task pid=502201)[0m           'val_files': '~/data/rlhf/gsm8k/test.parquet'},
[36m(main_task pid=502201)[0m  'reward_model': {'enable': False,
[36m(main_task pid=502201)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=502201)[0m                   'launch_reward_fn_async': False,
[36m(main_task pid=502201)[0m                   'max_length': None,
[36m(main_task pid=502201)[0m                   'micro_batch_size': None,
[36m(main_task pid=502201)[0m                   'micro_batch_size_per_gpu': None,
[36m(main_task pid=502201)[0m                   'model': {'external_lib': None,
[36m(main_task pid=502201)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=502201)[0m                                             'min_num_params': 0,
[36m(main_task pid=502201)[0m                                             'param_offload': False},
[36m(main_task pid=502201)[0m                             'input_tokenizer': '/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct',
[36m(main_task pid=502201)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(main_task pid=502201)[0m                             'use_remove_padding': False},
[36m(main_task pid=502201)[0m                   'reward_manager': None,
[36m(main_task pid=502201)[0m                   'sandbox_fusion': {'max_concurrent': 64, 'url': None},
[36m(main_task pid=502201)[0m                   'strategy': 'fsdp',
[36m(main_task pid=502201)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=502201)[0m                   'use_dynamic_bsz': False},
[36m(main_task pid=502201)[0m  'trainer': {'critic_warmup': 0,
[36m(main_task pid=502201)[0m              'default_hdfs_dir': None,
[36m(main_task pid=502201)[0m              'default_local_dir': 'saves/test',
[36m(main_task pid=502201)[0m              'del_local_ckpt_after_load': False,
[36m(main_task pid=502201)[0m              'experiment_name': 'test',
[36m(main_task pid=502201)[0m              'logger': ['console', 'wandb'],
[36m(main_task pid=502201)[0m              'n_gpus_per_node': 4,
[36m(main_task pid=502201)[0m              'nnodes': 1,
[36m(main_task pid=502201)[0m              'project_name': 'ag',
[36m(main_task pid=502201)[0m              'remove_previous_ckpt_in_save': False,
[36m(main_task pid=502201)[0m              'resume_from_path': False,
[36m(main_task pid=502201)[0m              'resume_mode': 'auto',
[36m(main_task pid=502201)[0m              'save_freq': 25,
[36m(main_task pid=502201)[0m              'storage_mode': 'local',
[36m(main_task pid=502201)[0m              'test_freq': -1,
[36m(main_task pid=502201)[0m              'total_epochs': 10,
[36m(main_task pid=502201)[0m              'total_training_steps': None,
[36m(main_task pid=502201)[0m              'val_generations_to_log_to_wandb': 0}}
[36m(main_task pid=502201)[0m [validate_config] All configuration checks passed successfully!
[36m(main_task pid=502201)[0m dataset len: 2120
[36m(main_task pid=502201)[0m Size of train dataloader: 530
[36m(main_task pid=502201)[0m Total training steps: 5300
[36m(WorkerDict pid=504517)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=504517)[0m   "architectures": [
[36m(WorkerDict pid=504517)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=504517)[0m   ],
[36m(WorkerDict pid=504517)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=504517)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=504517)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=504517)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=504517)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=504517)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=504517)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=504517)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=504517)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=504517)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=504517)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=504517)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=504517)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=504517)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=504517)[0m   "rope_scaling": null,
[36m(WorkerDict pid=504517)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=504517)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=504517)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=504517)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=504517)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=504517)[0m   "use_cache": true,
[36m(WorkerDict pid=504517)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=504517)[0m   "vocab_size": 151936
[36m(WorkerDict pid=504517)[0m }
[36m(WorkerDict pid=504517)[0m 
[36m(WorkerDict pid=504517)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=504517)[0m Qwen2ForCausalLM contains 3.09B parameters
[36m(WorkerDict pid=504517)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f1699f5c1f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f1699f5c0d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506457)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f74a57601f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f74a57600d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506459)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=506457)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=506458)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=504517)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerGroupRegisterCenter pid=506274)[0m [2025-11-21 11:40:56,652 E 506274 506401] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=506457)[0m [2025-11-21 11:40:57,671 E 506457 506571] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=506459)[0m [2025-11-21 11:40:57,683 E 506459 506602] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=506458)[0m [2025-11-21 11:40:57,732 E 506458 506635] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.92s/it]
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.02s/it]
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.06s/it]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.18s/it]
[36m(WorkerDict pid=506458)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.10s/it]
[36m(WorkerDict pid=506457)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.32s/it]
[36m(WorkerDict pid=506459)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.28s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.39s/it]
[36m(WorkerDict pid=504517)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.45s/it]
[36m(WorkerDict pid=504517)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=504517)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=506459)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506459)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=506457)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506457)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=506458)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506458)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=504517)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=504517)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=506459)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506459)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=506457)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506457)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=506458)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=506458)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=506457)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=506457)[0m   warnings.warn(
[36m(WorkerDict pid=506458)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=506458)[0m   warnings.warn(
[36m(WorkerDict pid=504517)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=504517)[0m   warnings.warn(
[36m(WorkerDict pid=506459)[0m /home/pct4et/envs/agog/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=506459)[0m   warnings.warn(
[36m(main_task pid=502201)[0m wandb: Currently logged in as: zhanwenchen (dri-ice) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(main_task pid=502201)[0m wandb: setting up run sdfqm0wl
[36m(main_task pid=502201)[0m wandb: Tracking run with wandb version 0.23.0
[36m(main_task pid=502201)[0m wandb: Run data is saved locally in /sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/wandb/run-20251121_114134-sdfqm0wl
[36m(main_task pid=502201)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(main_task pid=502201)[0m wandb: Syncing run test
[36m(main_task pid=502201)[0m wandb: ⭐️ View project at https://wandb.ai/dri-ice/ag
[36m(main_task pid=502201)[0m wandb: 🚀 View run at https://wandb.ai/dri-ice/ag/runs/sdfqm0wl
[36m(main_task pid=502201)[0m wandb: Detected [openai] in use.
[36m(main_task pid=502201)[0m wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[36m(main_task pid=502201)[0m wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
[36m(WorkerDict pid=506458)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f4d489601f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f4d489600d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506459)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f8e3c7541f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f8e3c7540d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506457)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=506459)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=504517)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=506458)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=504517)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=504517)[0m   "architectures": [
[36m(WorkerDict pid=504517)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=504517)[0m   ],
[36m(WorkerDict pid=504517)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=504517)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=504517)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=504517)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=504517)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=504517)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=504517)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=504517)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=504517)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=504517)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=504517)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=504517)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=504517)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=504517)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=504517)[0m   "rope_scaling": null,
[36m(WorkerDict pid=504517)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=504517)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=504517)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=504517)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=504517)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=504517)[0m   "use_cache": true,
[36m(WorkerDict pid=504517)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=504517)[0m   "vocab_size": 151936
[36m(WorkerDict pid=504517)[0m }
[36m(WorkerDict pid=504517)[0m 
[36m(WorkerDict pid=504517)[0m Qwen2ForCausalLM contains 3.09B parameters
[36m(WorkerDict pid=504517)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f1699f5c1f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f1699f5c0d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506457)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f74a57601f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f74a57600d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506458)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f4d489601f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f4d489600d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506459)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f8e3c7541f0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f8e3c7540d0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=506457)[0m Total steps: 5300, num_warmup_steps: 0
[36m(WorkerDict pid=506457)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=506459)[0m Total steps: 5300, num_warmup_steps: 0
[36m(WorkerDict pid=506459)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=504517)[0m Total steps: 5300, num_warmup_steps: 0
[36m(WorkerDict pid=504517)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=504517)[0m Before building vllm rollout, memory allocated (GB): 2.8740057945251465, memory reserved (GB): 6.935546875
[36m(WorkerDict pid=506458)[0m Total steps: 5300, num_warmup_steps: 0
[36m(WorkerDict pid=506458)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=504517)[0m INFO 11-21 11:41:21 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=504517)[0m WARNING 11-21 11:41:21 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=506458)[0m INFO 11-21 11:41:21 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=506458)[0m WARNING 11-21 11:41:21 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=506459)[0m INFO 11-21 11:41:21 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=506459)[0m WARNING 11-21 11:41:21 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=504517)[0m local rank 0
[36m(WorkerDict pid=504517)[0m INFO 11-21 11:41:21 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506457)[0m INFO 11-21 11:41:21 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=506457)[0m WARNING 11-21 11:41:21 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=506458)[0m local rank 0
[36m(WorkerDict pid=506458)[0m INFO 11-21 11:41:21 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506459)[0m local rank 0
[36m(WorkerDict pid=506459)[0m INFO 11-21 11:41:21 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506457)[0m local rank 0
[36m(WorkerDict pid=506457)[0m INFO 11-21 11:41:22 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=504517)[0m INFO 11-21 11:41:25 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506457)[0m INFO 11-21 11:41:25 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506458)[0m INFO 11-21 11:41:25 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506459)[0m INFO 11-21 11:41:25 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=506457)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=506459)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=506458)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=504517)[0m before init cache memory allocated: 9.274729984GB, reserved: 9.334423552GB
[36m(WorkerDict pid=504517)[0m after init cache memory allocated: 38.21680384GB, reserved: 38.275121152GB
[36m(WorkerDict pid=506457)[0m kwargs: {'n': 1, 'logprobs': 1, 'max_tokens': 200, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=506458)[0m kwargs: {'n': 1, 'logprobs': 1, 'max_tokens': 200, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=504517)[0m kwargs: {'n': 1, 'logprobs': 1, 'max_tokens': 200, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=504517)[0m After building vllm rollout, memory allocated (GB): 29.844163417816162, memory reserved (GB): 35.646484375
[36m(WorkerDict pid=504517)[0m After building sharding manager, memory allocated (GB): 29.844163417816162, memory reserved (GB): 35.646484375
[36m(WorkerDict pid=506459)[0m kwargs: {'n': 1, 'logprobs': 1, 'max_tokens': 200, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(main_task pid=502201)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(WorkerDict pid=504517)[0m Running rounds:   0%|          | 0/20 [00:00<?, ?it/s]Rounds 1/20 | Active agents per gpu: 1:   0%|          | 0/20 [00:00<?, ?it/s]
[36m(WorkerDict pid=504517)[0m Rounds 1/20 | Active agents per gpu: 1:   5%|▌         | 1/20 [00:01<00:37,  1.98s/it]Rounds 2/20 | Active agents per gpu: 1:   5%|▌         | 1/20 [00:01<00:37,  1.98s/it]
[36m(WorkerDict pid=504517)[0m Rounds 2/20 | Active agents per gpu: 1:  10%|█         | 2/20 [00:03<00:35,  1.98s/it]Rounds 3/20 | Active agents per gpu: 1:  10%|█         | 2/20 [00:03<00:35,  1.98s/it]
[36m(WorkerDict pid=504517)[0m Rounds 3/20 | Active agents per gpu: 1:  15%|█▌        | 3/20 [00:05<00:30,  1.79s/it]Rounds 4/20 | Active agents per gpu: 1:  15%|█▌        | 3/20 [00:05<00:30,  1.79s/it]
[36m(WorkerDict pid=504517)[0m Rounds 4/20 | Active agents per gpu: 1:  20%|██        | 4/20 [00:07<00:30,  1.90s/it]Rounds 5/20 | Active agents per gpu: 1:  20%|██        | 4/20 [00:07<00:30,  1.90s/it]
[36m(WorkerDict pid=504517)[0m Rounds 5/20 | Active agents per gpu: 1:  25%|██▌       | 5/20 [00:09<00:29,  1.94s/it]Rounds 6/20 | Active agents per gpu: 1:  25%|██▌       | 5/20 [00:09<00:29,  1.94s/it]
[36m(WorkerDict pid=504517)[0m Rounds 6/20 | Active agents per gpu: 1:  30%|███       | 6/20 [00:11<00:28,  2.02s/it]Rounds 7/20 | Active agents per gpu: 1:  30%|███       | 6/20 [00:11<00:28,  2.02s/it]
[36m(WorkerDict pid=504517)[0m Rounds 7/20 | Active agents per gpu: 1:  35%|███▌      | 7/20 [00:14<00:28,  2.22s/it]Rounds 8/20 | Active agents per gpu: 1:  35%|███▌      | 7/20 [00:14<00:28,  2.22s/it]
[36m(WorkerDict pid=504517)[0m Rounds 8/20 | Active agents per gpu: 1:  40%|████      | 8/20 [00:16<00:27,  2.28s/it]Rounds 9/20 | Active agents per gpu: 1:  40%|████      | 8/20 [00:16<00:27,  2.28s/it]
[36m(WorkerDict pid=504517)[0m Rounds 9/20 | Active agents per gpu: 1:  45%|████▌     | 9/20 [00:19<00:27,  2.49s/it]Rounds 10/20 | Active agents per gpu: 1:  45%|████▌     | 9/20 [00:19<00:27,  2.49s/it]
[36m(WorkerDict pid=504517)[0m Rounds 10/20 | Active agents per gpu: 1:  50%|█████     | 10/20 [00:22<00:24,  2.43s/it]Rounds 11/20 | Active agents per gpu: 1:  50%|█████     | 10/20 [00:22<00:24,  2.43s/it]
[36m(WorkerDict pid=504517)[0m Rounds 11/20 | Active agents per gpu: 1:  55%|█████▌    | 11/20 [00:23<00:20,  2.23s/it]Rounds 12/20 | Active agents per gpu: 1:  55%|█████▌    | 11/20 [00:23<00:20,  2.23s/it]
[36m(WorkerDict pid=504517)[0m Rounds 12/20 | Active agents per gpu: 1:  60%|██████    | 12/20 [00:26<00:19,  2.42s/it]Rounds 13/20 | Active agents per gpu: 1:  60%|██████    | 12/20 [00:26<00:19,  2.42s/it]
[36m(WorkerDict pid=504517)[0m Rounds 13/20 | Active agents per gpu: 1:  65%|██████▌   | 13/20 [00:28<00:15,  2.24s/it]Rounds 14/20 | Active agents per gpu: 1:  65%|██████▌   | 13/20 [00:28<00:15,  2.24s/it]
[36m(WorkerDict pid=504517)[0m Rounds 14/20 | Active agents per gpu: 1:  70%|███████   | 14/20 [00:30<00:13,  2.18s/it]Rounds 15/20 | Active agents per gpu: 1:  70%|███████   | 14/20 [00:30<00:13,  2.18s/it]
[36m(WorkerDict pid=504517)[0m Rounds 15/20 | Active agents per gpu: 1:  75%|███████▌  | 15/20 [00:32<00:10,  2.07s/it]Rounds 16/20 | Active agents per gpu: 1:  75%|███████▌  | 15/20 [00:32<00:10,  2.07s/it]
[36m(WorkerDict pid=504517)[0m Rounds 16/20 | Active agents per gpu: 1:  80%|████████  | 16/20 [00:35<00:09,  2.26s/it]Rounds 17/20 | Active agents per gpu: 1:  80%|████████  | 16/20 [00:35<00:09,  2.26s/it]
[36m(WorkerDict pid=504517)[0m Rounds 17/20 | Active agents per gpu: 1:  85%|████████▌ | 17/20 [00:37<00:06,  2.24s/it]Rounds 18/20 | Active agents per gpu: 1:  85%|████████▌ | 17/20 [00:37<00:06,  2.24s/it]
[36m(WorkerDict pid=504517)[0m Rounds 18/20 | Active agents per gpu: 1:  90%|█████████ | 18/20 [00:39<00:04,  2.13s/it]Rounds 19/20 | Active agents per gpu: 1:  90%|█████████ | 18/20 [00:39<00:04,  2.13s/it]
[36m(WorkerDict pid=504517)[0m Rounds 19/20 | Active agents per gpu: 1:  95%|█████████▌| 19/20 [00:42<00:02,  2.46s/it]Rounds 20/20 | Active agents per gpu: 1:  95%|█████████▌| 19/20 [00:42<00:02,  2.46s/it]
[36m(WorkerDict pid=504517)[0m Rounds 20/20 | Active agents per gpu: 1: 100%|██████████| 20/20 [00:44<00:00,  2.49s/it]Rounds 20/20 | Active agents per gpu: 1: 100%|██████████| 20/20 [00:44<00:00,  2.25s/it]
[36m(main_task pid=502201)[0m Checkpoint tracker file does not exist: %s /sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/saves/test/latest_checkpointed_iteration.txt
[36m(main_task pid=502201)[0m Training from scratch
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. Lease ID: 0300000094cf78d554002e892986aa5a89056d26c96c083176665e610c551705 Worker ID: 93f8fe7bfd79eedbf2ea21dd9625fb67f8cecb3fb1d37768799c0f21 Node ID: 2f6afd5fad645c58439c49a638efec77b935fd1f28babcb1dfbe1f92 Worker IP address: 10.250.133.91 Worker port: 34523 Worker PID: 506458 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 2. End of file. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'algorithm.rounds_ctrl.type=fixed', 'algorithm.rounds_ctrl.rounds=20', 'data.train_file=AgentItemId/sciworld_train.json', 'data.train_batch_size=4', 'data.max_prompt_length=1024', 'data.max_response_length=4096', 'actor_rollout_ref.agentgym.task_name=sciworld', 'actor_rollout_ref.agentgym.env_addr=http://localhost:36001', 'actor_rollout_ref.agentgym.timeout=600', 'actor_rollout_ref.model.path=/home/pct4et/agentgym_rl/models/Qwen2.5-3B-Instruct', 'actor_rollout_ref.actor.use_kl_loss=True', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.kl_loss_type=low_var_kl', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.40', 'actor_rollout_ref.rollout.n=1', 'actor_rollout_ref.rollout.max_model_len=32768', 'actor_rollout_ref.rollout.max_tokens=200', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.actor.ppo_epochs=1', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.actor.ppo_mini_batch_size=1', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1', 'actor_rollout_ref.rollout.rollout_log_dir=saves/test/executer_logs', 'algorithm.kl_ctrl.kl_coef=0.001', 'trainer.default_local_dir=saves/test', 'trainer.n_gpus_per_node=4', 'trainer.nnodes=1', 'trainer.project_name=ag', 'trainer.experiment_name=test', 'trainer.save_freq=25', 'trainer.total_epochs=10']
Traceback (most recent call last):
  File "/home/pct4et/envs/agog/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/pct4et/envs/agog/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/agent_trainer/main_ppo.py", line 96, in <module>
    main()
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/agent_trainer/main_ppo.py", line 25, in main
    run_ppo(config)
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/agent_trainer/main_ppo.py", line 33, in run_ppo
    ray.get(main_task.remote(config))
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/ray/_private/worker.py", line 2961, in get
    values, debugger_breakpoint = worker.get_objects(
  File "/home/pct4et/envs/agog/lib/python3.10/site-packages/ray/_private/worker.py", line 1026, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ActorDiedError): [36mray::main_task()[39m (pid=502201, ip=10.250.133.91)
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/agent_trainer/main_ppo.py", line 88, in main_task
    trainer.fit()
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/agent_trainer/ppo/ray_trainer.py", line 859, in fit
    actor_output = self.actor_rollout_wg.update_actor(batch)
  File "/sfs/gpfs/tardis/home/pct4et/agentgym_rl/AgentGym-RL/verl/single_controller/ray/base.py", line 42, in func
    output = ray.get(output)
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: create_colocated_worker_cls.<locals>.WorkerDict
	actor_id: 676ef700beec4ec415a7b79b01000000
	pid: 506458
	name: XgzodkWorkerDict_0:2
	namespace: 48e0ebbe-977e-4768-b9d2-297f042023b1
	ip: 10.250.133.91
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker unexpectedly exits with a connection error code 2. End of file. There are some potential root causes. (1) The process is killed by SIGKILL by OOM killer due to high memory usage. (2) ray stop --force is called. (3) The worker is crashed unexpectedly due to SIGSEGV or other unexpected errors.
+ status=1
+ exit 1
